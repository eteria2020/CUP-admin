<?php
$this->headLink()
    ->appendStylesheet('/js/datatables/plugins/bootstrap/dataTables.bootstrap.css')
    ->appendStylesheet('/plugins/bootstrap-datepicker/css/datepicker3.css');
$this->headScript()
    ->appendFile('/js/datatables/media/js/jquery.dataTables.min.js')
    ->appendFile('/js/datatables/plugins/bootstrap/dataTables.bootstrap.js')
    ->appendFile('/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js')
    ->prependFile('/js/jquery.validate-messages-it.js')
    ->prependFile('/js/jquery.validate.min.js')
    ->appendFile($this->basePath() .'/js/customers.js');
?>
<div class="page-content-wrapper">
    <div class="page-content">

        <div class="row">
            <div class="col-lg-6">
                <h3 class="page-title">
                    MODIFICA CLIENTE <small><?= $this->customer->getName() . ' ' . $this->customer->getSurname(); ?></small>
                </h3>
            </div>

            <div class="col-lg-6">
                <a href="<?php echo $this->url('customers'); ?>" class="btn btn-success pull-right"><i class="fa fa-arrow-left"></i> Torna alla lista</a>
            </div>
        </div>

        <div class="page-bar">
        </div>

        <div class="row">
            <div class="col-md-12">
                <ul class="nav nav-tabs" id="js-tabs" role="tablist">
                    <li role="presentation" class="active"><a href="<?= $this->url('customers/ajax-tab-info', ['id' => $this->customer->getId()]); ?>" data-target="#info" role="tab" data-toggle="tab">Informazioni</a></li>
                    <li role="presentation"><a href="<?= $this->url('customers/ajax-tab-edit', ['id' => $this->customer->getId()]); ?>" data-target="#edit" role="tab" data-toggle="tab">Modifica</a></li>
                    <li role="presentation"><a href="<?= $this->url('customers/ajax-tab-bonus', ['id' => $this->customer->getId()]); ?>" data-target="#bonus" role="tab" data-toggle="tab">Bonus</a></li>
                </ul>

                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane active" id="info"></div>
                    <div role="tabpanel" class="tab-pane" id="edit"></div>
                    <div role="tabpanel" class="tab-pane" id="bonus"></div>
                </div>
            </div>
        </div>

        <!-- END PAGE CONTENT-->
    </div>
</div>

<?php
echo $this->inlineScript()->captureStart();
echo <<<JS
$(document).ready(function () {

    var href = $('#js-tabs .active a').attr("href");

    $('#info').load(href,function(e){
      $('#js-tabs .active a').tab('show');
    });

    $('#js-tabs a').click(function(e) {
        var _this = $(this);
        var loadurl = _this.attr('href');
        var targ = _this.attr('data-target');

        $.get(loadurl, function(data) {
            $(targ).html(data);
        });

        _this.tab('show');
        return false;
    });
});
JS;
$this->inlineScript()->captureEnd(); ?>